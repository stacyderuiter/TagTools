<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Complementary filtering for acceleration: low- &amp; high-frequency • tagtools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Complementary filtering for acceleration: low- &amp; high-frequency">
<meta property="og:description" content="tagtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tagtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Detectors.html">Detectors</a>
    </li>
    <li>
      <a href="../articles/TagTools.html">Tagtools vignettes: overview and introduction</a>
    </li>
    <li>
      <a href="../articles/acceleration-filtering.html">Complementary filtering for acceleration: low- &amp; high-frequency</a>
    </li>
    <li>
      <a href="../articles/data-quality-error-correction.html">Data quality &amp; error correction</a>
    </li>
    <li>
      <a href="../articles/detectors-draft.html">detectors draft</a>
    </li>
    <li>
      <a href="../articles/dive-stats.html">Using dive_stats</a>
    </li>
    <li>
      <a href="../articles/find-dives.html">Using find_dives</a>
    </li>
    <li>
      <a href="../articles/fine-scale-tracking.html">Fine-scale tracking</a>
    </li>
    <li>
      <a href="../articles/install-load-tagtools.html">Installing and loading tagtools</a>
    </li>
    <li>
      <a href="../articles/jerk-transients.html">Jerk: a way to emphasize rapid changes in acceleration</a>
    </li>
    <li>
      <a href="../articles/load-tag-data.html">Load tag data</a>
    </li>
    <li>
      <a href="../articles/magnetometer-filtering.html">More complementary filtering: magnetometer &amp; dynamic acceleration</a>
    </li>
    <li>
      <a href="../articles/mahalanobis-distance.html">Mahalanobis distance</a>
    </li>
    <li>
      <a href="../articles/plots-and-cropping.html">Plots and cropping</a>
    </li>
    <li>
      <a href="../articles/rotation-test.html">Rotation test</a>
    </li>
    <li>
      <a href="../articles/tag-to-whale-frame.html">Tag orientation: From tag frame to sperm whale frame</a>
    </li>
    <li>
      <a href="../articles/vectors-vs-structures.html">Vectors and scalars versus structures</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="acceleration-filtering_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Complementary filtering for acceleration: low- &amp; high-frequency</h1>
                        <h4 class="author">tagtools project team</h4>
            
            <h4 class="date">2021-08-18</h4>
      
      
      <div class="hidden name"><code>acceleration-filtering.Rmd</code></div>

    </div>

    
    
<p>Welcome to the <code>acceleration-filtering</code> vignette! Thanks for taking some time to learn our package; we hope it’s, thus far, all you’ve dreamed it would be.</p>
<p>In this vignette, you will explore postural dynamics and specific acceleration in the time and frequency domains. Specifically, you’ll load in some new data and use complementary filters to separate intervals of movements into distinct frequency bands, i.e., posture (low frequency) and strikes/flinches (high frequency), in order to gain insight about the movements of a beaked whale.</p>
<p><em>Estimated time for this practical: 20 minutes.</em></p>
<p>These vignettes all assume that you have R/Rstudio installed on your machine, some basic experience working with them, and can execute provided code, making some user-specific changes along the way (e.g. to help R find a file you downloaded). We will provide you with quite a few lines. To boost your own learning, you would do well to try and write them before opening what we give, using this just to check your work.</p>
<p>Additionally, be careful when copy-pasting special characters such as _underscores_ and ‘quotes’. If you get an error, one thing to check is that you have just a single, simple underscore, and <code>'straight quotes'</code>, whether <code>'single'</code> or <code>"double"</code> (rather than “smart quotes”).</p>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<p>For this vignette we will use data from a suction cup tag attached to the back of a beaked whale. This dataset is built into the <code>tagtools</code> package, so you can access it using <code>system.file</code>.</p>
<p>Write <code>testset1</code> to the object <code>bw</code>, for “beaked whale”. Then use <code><a href="../reference/plott.html">plott()</a></code> to inspect it.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tagtools</span><span class="op">)</span>
<span class="va">bw_file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"testset1.nc"</span>, package <span class="op">=</span> <span class="st">"tagtools"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">bw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_nc.html">load_nc</a></span><span class="op">(</span><span class="va">bw_file_path</span><span class="op">)</span>
<span class="fu"><a href="../reference/plott.html">plott</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">bw</span><span class="op">$</span><span class="va">P</span>, Acc <span class="op">=</span> <span class="va">bw</span><span class="op">$</span><span class="va">A</span>, Mag <span class="op">=</span> <span class="va">bw</span><span class="op">$</span><span class="va">M</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<button class="btn btn-primary" data-toggle="collapse" data-target="#plott_bw">
Show/Hide Results
</button>
<div id="plott_bw" class="collapse">
<p><img src="acceleration-filtering_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<p>This dataset contains a deep dive followed by a shallow dive. We want to infer the function of these by looking for locomotion effort and sudden changes in acceleration that could be indicative of prey capture attempts. We are also going to look for changes in swimming gait.</p>
</div>
<div id="complementary-filtering" class="section level1">
<h1 class="hasAnchor">
<a href="#complementary-filtering" class="anchor"></a>Complementary filtering</h1>
<p>To separate slow orientation changes from postural dynamics in locomotion, we need to choose a filter cut-off frequency below the stroke frequency. We can estimate the dominant stroke frequency using <code><a href="../reference/dsf.html">dsf()</a></code>. There is a bout of steady swimming between minutes 35 and 42 in the data. Use <code><a href="../reference/crop_to.html">crop_to()</a></code> to pick out the accelerometer data in that interval:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Aseg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop_to.html">crop_to</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">bw</span><span class="op">$</span><span class="va">A</span>, tcues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">35</span><span class="op">*</span><span class="fl">60</span>, <span class="fl">42</span><span class="op">*</span><span class="fl">60</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Mimic the previous code to similarly crop the pressure (depth) and magnetometer data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Dseg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop_to.html">crop_to</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">bw</span><span class="op">$</span><span class="va">P</span>, tcues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">35</span><span class="op">*</span><span class="fl">60</span>, <span class="fl">42</span><span class="op">*</span><span class="fl">60</span><span class="op">)</span><span class="op">)</span>
<span class="va">Mseg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop_to.html">crop_to</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">bw</span><span class="op">$</span><span class="va">M</span>, tcues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">35</span><span class="op">*</span><span class="fl">60</span>, <span class="fl">42</span><span class="op">*</span><span class="fl">60</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Plot the three of them together to make sure you got it right.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plott.html">plott</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">Dseg</span>, Acc <span class="op">=</span> <span class="va">Aseg</span>, Mag <span class="op">=</span> <span class="va">Mseg</span><span class="op">)</span>, interactive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<button class="btn btn-primary" data-toggle="collapse" data-target="#plott_seg">
Show/Hide Results
</button>
<div id="plott_seg" class="collapse">
<p><img src="acceleration-filtering_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<p>Then, run <code><a href="../reference/dsf.html">dsf()</a></code> on <code>Aseg</code> to get the mean stroking rate:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dsfa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dsf.html">dsf</a></span><span class="op">(</span><span class="va">Aseg</span><span class="op">)</span><span class="op">$</span><span class="va">fpk</span>   <span class="co"># estimated stroking rate in Hz</span></code></pre></div>
<p>Try doing the same with the magnetometer data:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dsfm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dsf.html">dsf</a></span><span class="op">(</span><span class="va">Mseg</span><span class="op">)</span><span class="op">$</span><span class="va">fpk</span> <span class="co"># another estimate</span></code></pre></div>
<p>Are the estimated stroke rates similar?</p>
<button class="btn btn-primary" data-toggle="collapse" data-target="#ans_est_stroke_rate">
<em>Show/Hide Answer</em>
</button>
<div id="ans_est_stroke_rate" class="collapse">
<p><em>Yes, they should be. The acceleration-based estimate is .3821574, and the magnetometer-based estimate is .3807932.</em></p>
</div>
<p>The magnetometer is not sensitive to specific acceleration, so why do stroking motions show up in <code>Mseg</code>?</p>
<button class="btn btn-primary" data-toggle="collapse" data-target="#ans_axis_of_stroking">
<em>Show/Hide Answer</em>
</button>
<div id="ans_axis_of_stroking" class="collapse">
<p><em>The animal is changing its position, so the magnetometer reading will change.</em></p>
</div>
<p>Refer to your plots of <code>Mseg</code> and <code>Dseg</code> to try and figure out which axis the stroking motions show up in.</p>
<!-- *Probably Z? Maybe X? Whichever one is moving up and down. Could be X. Need to figure out color scheme in R.* -->
<p>A good starting choice for the filter cut-off frequency is 70% of the stroking rate (pick one of the estimates, or average the two). Call this value <code>fc</code>. Run a complementary filter on <code>A</code> to separate the slow and fast time-scales. Recall that <code>A</code> is stored under <code>bw</code> as <code>bw$A</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fc</span> <span class="op">&lt;-</span> <span class="st">'YourValueHere'</span>           <span class="co"># your value for fc in Hz, a number, without quotes</span>
<span class="va">Af</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/comp_filt.html">comp_filt</a></span><span class="op">(</span><span class="va">bw</span><span class="op">$</span><span class="va">A</span>, fc <span class="op">=</span> <span class="va">fc</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">Af</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </code></pre></div>
<button class="btn btn-primary" data-toggle="collapse" data-target="#Af">
Show/Hide Results
</button>
<div id="Af" class="collapse">
<pre><code>#&gt; List of 2
#&gt;  $ lowpass : num [1:137976, 1:3] -1.22 -1.22 -1.21 -1.19 -1.17 ...
#&gt;  $ highpass: num [1:137976, 1:3] -0.624 -0.558 -0.516 -0.511 -0.471 ...</code></pre>
</div>
<p>The complementary filter returns a list containing two data matrices: the low-pass filtered data and the high-pass filtered data. Each of these is a three-column matrix because the filter is run on each column of the input data. So it is like you now have two accelerometers in the tag—one is only sensitive to low frequencies and the other is only sensitive to high frequencies. If you would like to get each matrix out of the cell array, do:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Alow</span> <span class="op">&lt;-</span> <span class="va">Af</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>     <span class="co"># low frequency A data</span>
<span class="va">Ahigh</span> <span class="op">&lt;-</span> <span class="va">Af</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>      <span class="co"># high frequency A data</span></code></pre></div>
<p>The sampling rate of these is the same as for the original data. For simplicity, make a variable <code>sampling_rate</code> equal to the sampling rate and use <code><a href="../reference/plott.html">plott()</a></code> to plot the two filtered accelerations along with the dive profile:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sampling_rate</span> <span class="op">&lt;-</span> <span class="va">bw</span><span class="op">$</span><span class="va">A</span><span class="op">$</span><span class="va">sampling_rate</span>
<span class="fu"><a href="../reference/plott.html">plott</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>`Depth (m)` <span class="op">=</span> <span class="va">bw</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">data</span>,
               `LF Accel` <span class="op">=</span> <span class="va">Alow</span>, 
               `HF Accel` <span class="op">=</span> <span class="va">Ahigh</span><span class="op">)</span>,
      fsx <span class="op">=</span> <span class="va">sampling_rate</span><span class="op">)</span></code></pre></div>
<button class="btn btn-primary" data-toggle="collapse" data-target="#plott_lowNhigh">
Show/Hide Results
</button>
<div id="plott_lowNhigh" class="collapse">
<p><img src="acceleration-filtering_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<p>These two versions of acceleration are sometimes called ‘static’ and ‘dynamic’ acceleration. If the filtering worked, you should see that <code>Alow</code> has large, relatively slow changes in acceleration which are mostly to do with orientation. These are missing in <code>Ahigh</code>, which has the high frequency specific acceleration, having to do with propulsion and strikes or flinches.</p>
<p>If you like, zoom in to the section of steady stroking that you used for <code>dsf</code>—you should only see the stroking in <code>Ahigh</code>, not in <code>Alow</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plott.html">plott</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>`Depth` <span class="op">=</span> <span class="va">bw</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">data</span>,
               `LF Accel` <span class="op">=</span> <span class="va">Alow</span>, 
               `HF Accel` <span class="op">=</span> <span class="va">Ahigh</span><span class="op">)</span>,
      fsx <span class="op">=</span> <span class="va">sampling_rate</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">35</span><span class="op">*</span><span class="fl">60</span>, <span class="fl">42</span><span class="op">*</span><span class="fl">60</span><span class="op">)</span><span class="op">/</span><span class="fl">3600</span><span class="op">)</span></code></pre></div>
<button class="btn btn-primary" data-toggle="collapse" data-target="#plott_lowNhigh_zoomd">
Show/Hide Results
</button>
<div id="plott_lowNhigh_zoomd" class="collapse">
<p><img src="acceleration-filtering_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
</div>
<div id="locomotion-style" class="section level1">
<h1 class="hasAnchor">
<a href="#locomotion-style" class="anchor"></a>Locomotion style</h1>
<p>We want to characterise the locomotion style of the animal during the deep-dive ascent. Using the plot you made above, zoom in on the ascent and see if you can identify intervals in which the animal appears to be just swimming steadily (hint: look for when <code>Alow</code> is fairly constant, indicating a steady orientation).</p>
<p>Do you see any changes in swimming style throughout the ascent? In particular, check out the swimming styles in time intervals (1) 36-38 minutes and (2) 56-58 minutes. Write two objects (say, <code>intvl1</code> and <code>intvl2</code>) that contain these intervals in seconds, using <code><a href="https://rdrr.io/r/base/c.html">c(YourStartTime, YourEndTime)</a></code>. Then, crop out the high frequency acceleration data in each of these intervals using <code><a href="../reference/crop_to.html">crop_to(...)</a></code>. (Try and write the code yourself!)</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">intvl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">36</span><span class="op">*</span><span class="fl">60</span>, <span class="fl">38</span><span class="op">*</span><span class="fl">60</span><span class="op">)</span>
<span class="va">intvl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">56</span><span class="op">*</span><span class="fl">60</span>, <span class="fl">58</span><span class="op">*</span><span class="fl">60</span><span class="op">)</span>
<span class="va">Ah1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop_to.html">crop_to</a></span><span class="op">(</span><span class="va">Ahigh</span>, sampling_rate <span class="op">=</span> <span class="va">sampling_rate</span>, tcues <span class="op">=</span> <span class="va">intvl1</span><span class="op">)</span>
<span class="va">Ah2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop_to.html">crop_to</a></span><span class="op">(</span><span class="va">Ahigh</span>, sampling_rate <span class="op">=</span> <span class="va">sampling_rate</span>, tcues <span class="op">=</span> <span class="va">intvl2</span><span class="op">)</span></code></pre></div>
<p>Now plott these together. Be careful when comparing, since plott puts them on different y-scales automatically to fit the data to the window!</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plott.html">plott</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Ah1 <span class="op">=</span> <span class="va">Ah1</span>, Ah2 <span class="op">=</span> <span class="va">Ah2</span><span class="op">)</span>, fsx <span class="op">=</span> <span class="va">sampling_rate</span>, xl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<button class="btn btn-primary" data-toggle="collapse" data-target="#plott_Ah1Ah2">
Show/Hide Results
</button>
<div id="plott_Ah1Ah2" class="collapse">
<p><img src="acceleration-filtering_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<p>Comparing these two intervals of swimming, what do you conclude about the swimming styles? Look at the magnitude of the acceleration (the units are in <span class="math inline">\(m/s^2\)</span>). You may want to compare the depth data in these intervals, too.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">D1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop_to.html">crop_to</a></span><span class="op">(</span><span class="va">bw</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">data</span>, sampling_rate <span class="op">=</span> <span class="va">sampling_rate</span>, tcues <span class="op">=</span> <span class="va">intvl1</span><span class="op">)</span>
<span class="va">D2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop_to.html">crop_to</a></span><span class="op">(</span><span class="va">bw</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">data</span>, sampling_rate <span class="op">=</span> <span class="va">sampling_rate</span>, tcues <span class="op">=</span> <span class="va">intvl2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">D1</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="op">(</span><span class="op">-</span><span class="va">D1</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"samples"</span>, ylab <span class="op">=</span> <span class="st">"Depth"</span><span class="op">)</span> <span class="co"># plott doesn't make it very clear</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">D2</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="op">(</span><span class="op">-</span><span class="va">D2</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"samples"</span>, ylab <span class="op">=</span> <span class="st">"Depth"</span><span class="op">)</span> <span class="co"># so we'll just use plot</span></code></pre></div>
<button class="btn btn-primary" data-toggle="collapse" data-target="#plott_D1D2">
Show/Hide Results
</button>
<div id="plott_D1D2" class="collapse">
<p><img src="acceleration-filtering_files/figure-html/unnamed-chunk-20-1.png" width="700"><img src="acceleration-filtering_files/figure-html/unnamed-chunk-20-2.png" width="700"></p>
</div>
<p>Does one swimming style seem more energetic than the other?</p>
<button class="btn btn-primary" data-toggle="collapse" data-target="#answers_energeticRnaw">
<em>Show/Hide Answers</em>
</button>
<div id="answers_energeticRnaw" class="collapse">
<p><em>The magnitude of acceleration in each peak is lower in the first interval (between</em> <span class="math inline">\(-0.5\)</span> <em>and</em> <span class="math inline">\(+1\)</span> <span class="math inline">\(m/s^2\)</span><em>), and this time interval is a time when the animal is swimming steadily upwards. However, the acceleration is changing quickly back and forth: the peaks come much more frequently, so that there are 46 of them within the two minutes. The second time interval is different, with higher magnitudes of acceleration (between</em> <span class="math inline">\(-3\)</span> <em>and</em> <span class="math inline">\(+4\)</span> <span class="math inline">\(m/s^2\)</span><em>). This time interval is also a time when the animal is swimming slightly upwards, but there are more visually obvious “bumps” in the path upwards, which actually correspond to the individual acceleration peaks. Possibly, rather than just ascending to the surface, the whale is exerting itself, accelerating very quickly, to try to catch prey. Overall, this second swimming style seems more energetic than the first.</em></p>
</div>
<p>Finally go back and plot the full high frequency acceleration data, <code>Ahigh</code>, then a portion of it cropped to the shallow dive. Use this to see whether there is active swimming in the shallow dive and, if so, which swimming gait is used there.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plott.html">plott</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>`Depth` <span class="op">=</span> <span class="va">bw</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">data</span>,
               `LF Accel` <span class="op">=</span> <span class="va">Alow</span>, 
               `HF Accel` <span class="op">=</span> <span class="va">Ahigh</span><span class="op">)</span>,
      fsx <span class="op">=</span> <span class="va">sampling_rate</span><span class="op">)</span>
<span class="va">intvl3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">77</span><span class="op">*</span><span class="fl">60</span>, <span class="fl">89</span><span class="op">*</span><span class="fl">60</span><span class="op">)</span> <span class="co"># whole shallow dive, for context</span>
<span class="va">intvl4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">77</span><span class="op">*</span><span class="fl">60</span>, <span class="fl">79</span><span class="op">*</span><span class="fl">60</span><span class="op">)</span> <span class="co"># earlier in the shallow dive</span>
<span class="va">intvl5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">87</span><span class="op">*</span><span class="fl">60</span>, <span class="fl">89</span><span class="op">*</span><span class="fl">60</span><span class="op">)</span> <span class="co"># later in the shallow dive</span>
<span class="va">Ah3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop_to.html">crop_to</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">Ahigh</span>, sampling_rate <span class="op">=</span> <span class="va">sampling_rate</span>, tcues <span class="op">=</span> <span class="va">intvl3</span><span class="op">)</span>
<span class="va">D3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop_to.html">crop_to</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">bw</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">data</span>, sampling_rate <span class="op">=</span> <span class="va">sampling_rate</span>, tcues <span class="op">=</span> <span class="va">intvl3</span><span class="op">)</span>
<span class="va">Ah4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop_to.html">crop_to</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">Ahigh</span>, sampling_rate <span class="op">=</span> <span class="va">sampling_rate</span>, tcues <span class="op">=</span> <span class="va">intvl4</span><span class="op">)</span>
<span class="va">D4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop_to.html">crop_to</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">bw</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">data</span>, sampling_rate <span class="op">=</span> <span class="va">sampling_rate</span>, tcues <span class="op">=</span> <span class="va">intvl4</span><span class="op">)</span>
<span class="va">Ah5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop_to.html">crop_to</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">Ahigh</span>, sampling_rate <span class="op">=</span> <span class="va">sampling_rate</span>, tcues <span class="op">=</span> <span class="va">intvl5</span><span class="op">)</span>
<span class="va">D5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop_to.html">crop_to</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">bw</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">data</span>, sampling_rate <span class="op">=</span> <span class="va">sampling_rate</span>, tcues <span class="op">=</span> <span class="va">intvl5</span><span class="op">)</span> 
<span class="fu"><a href="../reference/plott.html">plott</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">D3</span>, HfAccel3 <span class="op">=</span> <span class="va">Ah3</span><span class="op">)</span>, fsx <span class="op">=</span> <span class="va">sampling_rate</span>, interactive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">D4</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">D4</span><span class="op">)</span>
<span class="fu"><a href="../reference/plott.html">plott</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>HfAccel4 <span class="op">=</span> <span class="va">Ah4</span><span class="op">)</span>, fsx <span class="op">=</span> <span class="va">sampling_rate</span>, interactive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">D5</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">D5</span><span class="op">)</span>
<span class="fu"><a href="../reference/plott.html">plott</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>HfAccel5 <span class="op">=</span> <span class="va">Ah5</span><span class="op">)</span>, fsx <span class="op">=</span> <span class="va">sampling_rate</span>, interactive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<button class="btn btn-primary" data-toggle="collapse" data-target="#plott_34">
Show/Hide Results
</button>
<div id="plott_34" class="collapse">
<p><img src="acceleration-filtering_files/figure-html/unnamed-chunk-22-1.png" width="700"><img src="acceleration-filtering_files/figure-html/unnamed-chunk-22-2.png" width="700"><img src="acceleration-filtering_files/figure-html/unnamed-chunk-22-3.png" width="700"><img src="acceleration-filtering_files/figure-html/unnamed-chunk-22-4.png" width="700"><img src="acceleration-filtering_files/figure-html/unnamed-chunk-22-5.png" width="700"><img src="acceleration-filtering_files/figure-html/unnamed-chunk-22-6.png" width="700"></p>
</div>
<p>Any similarities to the swimming earlier? Any differences?</p>
<button class="btn btn-primary" data-toggle="collapse" data-target="#answers_compareNcontrast">
<em>Show/Hide Answers</em>
</button>
<div id="answers_compareNcontrast" class="collapse">
<p><em>These two intervals look much more similar to <code>intvl2</code> than <code>intvl3</code>. Large spikes in acceleration are almost nonexistent, with the magnitude of acceleration usually neatly between</em> <span class="math inline">\(-1\)</span> and <span class="math inline">\(+1\)</span> <span class="math inline">\(m/s^2\)</span><em>. Further, the number of peaks in <code>intvl4</code> (47 peaks in 2 minutes) is almost exactly the same as that in <code>intvl2</code> (46 peaks in 2 minutes). <code>intvl5</code> is slightly more complicated. As the whale approaches zero depth before the end of <code>intvl5</code>, almost all acceleration stops momentarily during the final glide to the surface. Once at the surface, the behavior is more erratic, representing perhaps a kind of relaxed frolicking, rather than an efficient swim upwards.</em></p>
</div>
</div>
<div id="review" class="section level1">
<h1 class="hasAnchor">
<a href="#review" class="anchor"></a>Review</h1>
<p>You’ve learned how to separate low- and high-frequency acceleration data with a complementary filter, and done some interpretation of these two sets of data.</p>
<p>Aaaaand… congrats! You’ve aced this vignette.</p>
<p><em>If you’d like to continue working through these vignettes, <code>jerk-transients</code> is a very logical choice. So is <code>magnetometer-filtering</code>. These three vignettes all go together. Perhaps the most logical ordering is <code>acceleration-filtering</code>, then <code>jerk-transients</code>, then <code>magnetometer-filtering</code>. But, you do what suits your fancy/data!</em></p>
<hr>
<p>Animaltags home pages: <a href="http://animaltags.org/" class="uri">http://animaltags.org/</a> (old), <a href="https://animaltags.netlify.app/" class="uri">https://animaltags.netlify.app/</a> (new), <a href="https://github.com/stacyderuiter/TagTools" class="uri">https://github.com/stacyderuiter/TagTools</a> (for latest beta source code), <a href="https://stacyderuiter.github.io/TagTools/articles/TagTools" class="uri">https://stacyderuiter.github.io/TagTools/articles/TagTools</a> (vignettes overview)</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Stacy DeRuiter, Mark Johnson, David Sweeney, Ye Joo McNamara-Oh, Samuel Fynewever, (Oghenkevwe) Racheal Tejevbo, Tiago Marques.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
