<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mahalanobis distance • tagtools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Mahalanobis distance">
<meta property="og:description" content="tagtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tagtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/acceleration-filtering.html">Complementary filtering for acceleration: low- &amp; high-frequency</a>
    </li>
    <li>
      <a href="../articles/data-quality-error-correction.html">Data quality &amp; error correction</a>
    </li>
    <li>
      <a href="../articles/detectors-draft.html">detectors draft</a>
    </li>
    <li>
      <a href="../articles/Detectors.html">Detectors</a>
    </li>
    <li>
      <a href="../articles/dive-stats.html">Using dive_stats</a>
    </li>
    <li>
      <a href="../articles/find-dives.html">Using find_dives</a>
    </li>
    <li>
      <a href="../articles/fine-scale-tracking.html">Fine-scale tracking</a>
    </li>
    <li>
      <a href="../articles/install-load-tagtools.html">Installing and loading tagtools</a>
    </li>
    <li>
      <a href="../articles/jerk-transients.html">Jerk: a way to emphasize rapid changes in acceleration</a>
    </li>
    <li>
      <a href="../articles/load-tag-data.html">Load tag data</a>
    </li>
    <li>
      <a href="../articles/magnetometer-filtering.html">More complementary filtering: magnetometer &amp; dynamic acceleration</a>
    </li>
    <li>
      <a href="../articles/mahalanobis-distance.html">Mahalanobis distance</a>
    </li>
    <li>
      <a href="../articles/overview.html">Tagtools vignettes: overview and introduction</a>
    </li>
    <li>
      <a href="../articles/plots-and-cropping.html">Plots and cropping</a>
    </li>
    <li>
      <a href="../articles/rotation-test.html">Rotation test</a>
    </li>
    <li>
      <a href="../articles/tag-to-whale-frame.html">Tag orientation: From tag frame to sperm whale frame</a>
    </li>
    <li>
      <a href="../articles/vectors-vs-structures.html">Vectors and scalars versus structures</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="mahalanobis-distance_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Mahalanobis distance</h1>
                        <h4 class="author">tagtools project team</h4>
            
            <h4 class="date">2021-07-29</h4>
      
      
      <div class="hidden name"><code>mahalanobis-distance.Rmd</code></div>

    </div>

    
    
<p>Welcome to the Mahalanobis distance vignette! Thanks for taking some time to get to know our package. We hope it empowers you to make the world a better place for marine mammals.</p>
<p>In this vignette you will learn to use the function <code>m_dist</code>, which stands for Mahalanobis distance. You will use <code>m_dist</code> to consider the effect of military sonar on a Cuvier’s beaked whale.</p>
<p><em>Estimated time for this vignette: 25 minutes.</em></p>
<p>These practicals all assume that you have R/Rstudio, some basic experience working with them, and can execute provided code, making some user-specific changes along the way (e.g. to help R find a file you downloaded). We will provide you with quite a few lines. To boost your own learning, you would do well to try and write them before opening what we give, using this just to check your work.</p>
<p>Additionally, be careful when copy-pasting special characters such as _underscores_ and ‘quotes’. If you get an error, one thing to check is that you have just a single, simple underscore, and <code>'straight quotes'</code>, whether <code>'single'</code> or <code>"double"</code> (rather than “smart quotes”).</p>
<div id="what-is-mahalanobis-distance" class="section level1">
<h1 class="hasAnchor">
<a href="#what-is-mahalanobis-distance" class="anchor"></a>What is Mahalanobis distance?</h1>
<p>Put concisely, Mahalanobis distance is a way of comparing how different some data is to what we would expect it to be like. By plotting more than one variable and seeing what the distribution is like graphically, we can determine more accurately how out-of-the-ordinary something is by computing the distance from that point to the centroid of the points. The picture below is taken from Schwarz et al. 2012, J. Neuroscience Methods 206(2): 120-131 and appears in the “Statistics for”Tag Data" lecture on the animaltags website.</p>
<p><img src="../../../../../../Stacy%20DeRuiter/Dropbox/TagTools/R/tagtools/vignettes/mahalanobis-dist-illus.png" width="242"></p>
<p>See <a href="https://blogs.sas.com/content/iml/2012/02/15/what-is-mahalanobis-distance.html">this blog post</a> for another explanation of Mahalanobis distance. You can also consult slides on this topic in the “Statistics for Tag Data” lecture on the animaltags website, <a href="http://animaltags.org/" class="uri">http://animaltags.org/</a> or <a href="https://animaltags.netlify.app" class="uri">https://animaltags.netlify.app</a> .</p>
</div>
<div id="load-inspect-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-inspect-data" class="anchor"></a>Load &amp; inspect data</h1>
<p>Consider again the dataset zc11_267a. It is built into the <code>tagtools</code> package, so you can access it using <code>system.file</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tagtools</span><span class="op">)</span>
<span class="va">ZC_file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"zc11_267a.nc"</span>, package <span class="op">=</span> <span class="st">"tagtools"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">zc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_nc.html">load_nc</a></span><span class="op">(</span><span class="va">ZC_file_path</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">zc</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="../reference/plott.html">plott</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">zc</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">data</span>, Accel <span class="op">=</span> <span class="va">zc</span><span class="op">$</span><span class="va">A</span><span class="op">$</span><span class="va">data</span><span class="op">)</span>, fsx <span class="op">=</span> <span class="va">zc</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">sampling_rate</span>, interactive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<button class="btn btn-primary" data-toggle="collapse" data-target="#load_inspect_zc">
Show/Hide Results
</button>
<div id="load_inspect_zc" class="collapse">
<pre><code>#&gt; List of 4
#&gt;  $ A   :List of 18
#&gt;  $ P   :List of 18
#&gt;  $ head:List of 10
#&gt;  $ info:List of 19
#&gt;  - attr(*, "class")= chr [1:2] "animaltag" "list"</code></pre>
<p><img src="mahalanobis-distance_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<ol style="list-style-type: decimal">
<li><p>How might you use Mahalanobis distance to summarise the multivariate tag data into a single data stream? What input variables might you choose to try to quantify how the whale might have changed its behavior in response to sonar sounds? (If you need more context, you can check out the paper at <a href="http://rsbl.royalsocietypublishing.org/content/9/4/20130223" class="uri">http://rsbl.royalsocietypublishing.org/content/9/4/20130223</a>.)</p></li>
<li><p>Use the tag tool function m_dist to compute the Mahalanobis distance using your chosen inputs, using the model below as a guide (note that these choices of inputs are kind of ridiculous—do better!). You will have to choose an averaging window length and a between-window overlap. You can use the experiment start and end times provided. How would you justify these choices?</p></li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MDdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>jerk <span class="op">=</span> <span class="fu"><a href="../reference/njerk.html">njerk</a></span><span class="op">(</span><span class="va">zc</span><span class="op">$</span><span class="va">A</span>, sampling_rate <span class="op">=</span> <span class="va">zc</span><span class="op">$</span><span class="va">A</span><span class="op">$</span><span class="va">sampling_rate</span><span class="op">)</span><span class="op">$</span><span class="va">data</span>, Mx <span class="op">=</span> <span class="va">zc</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">data</span><span class="op">)</span>
<span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">'2011-09-24 14:45:00'</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">zc</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">dephist_device_datetime_start</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">3600</span>
<span class="va">eet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">'2011-09-24 15:15:00'</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">zc</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">dephist_device_datetime_start</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">3600</span>
<span class="va">MD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/m_dist.html">m_dist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">MDdata</span>, sampling_rate<span class="op">=</span><span class="va">zc</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">sampling_rate</span>, smoothDur <span class="op">=</span> <span class="fl">10</span>, overlap <span class="op">=</span> <span class="fl">9.5</span>, expStart <span class="op">=</span> <span class="va">est</span>, expEnd <span class="op">=</span> <span class="va">eet</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">MD</span><span class="op">$</span><span class="va">t</span>, <span class="va">MD</span><span class="op">$</span><span class="va">dist</span>, type <span class="op">=</span> <span class="st">'l'</span><span class="op">)</span></code></pre></div>
<button class="btn btn-primary" data-toggle="collapse" data-target="#MD_and_plot">
Show/Hide Results
</button>
<div id="MD_and_plot" class="collapse">
<p><img src="mahalanobis-distance_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<ol start="3" style="list-style-type: decimal">
<li><p>If you included dive depth as an input variable, how did it affect the resulting distance metric? Why do you think that is? Could there be another, better way to include information about dive profile in the Mahalanobis distance metric?</p></li>
<li><p>Do you think there was a “change” in behavior in response to the sonar exposure?</p></li>
<li><p>If you wanted to set a threshold for detecting a “change”, how would you do it?</p></li>
</ol>
</div>
<div id="review" class="section level1">
<h1 class="hasAnchor">
<a href="#review" class="anchor"></a>Review</h1>
<p>You’ve learned to use <code>m_dist</code> to calculate Mahalanobis distance with some real-world data. Well done!</p>
<p><em>If you’d like to continue working through these vignettes, consider <code>Detectors</code>, <code>rotation-test</code>, or <code>fine-scale-tracking</code>.</em></p>
<hr>
<p>Animaltags home pages: <a href="http://animaltags.org/" class="uri">http://animaltags.org/</a> (old), <a href="https://animaltags.netlify.app/" class="uri">https://animaltags.netlify.app/</a> (new), <a href="https://github.com/stacyderuiter/TagTools" class="uri">https://github.com/stacyderuiter/TagTools</a> (for source code)</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Stacy DeRuiter, Mark Johnson, David Sweeney, Ye Joo McNamara-Oh, Samuel Fynewever, (Oghenkevwe) Racheal Tejevbo, Tiago Marques.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
